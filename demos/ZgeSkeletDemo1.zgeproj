<?xml version="1.0" encoding="iso-8859-1" ?>
<ZApplication Name="App" Comment="Created by Rado1" Caption="Skelet Demo 1" ClearColor="0 0.251 0.502 1" AmbientLightColor="0.502 0.502 0.502 1" ScreenMode="0" CameraPosition="-200 -220 87.2" CameraRotation="-0.259 0 0.13" ViewportRatio="3" ClipFar="1000" MouseVisible="255" NoSound="1" AndroidPackageName="com.rado1.SkeletDemo1">
  <OnLoaded>
    <ZExternalLibrary Comment="Skeletal Animation Library" ModuleName="ZgeSkelet" CallingConvention="1" BeforeInitExp="if(ANDROID) this.ModuleName = &quot;./libZgeSkelet.so&quot;;">
      <Source>
<![CDATA[/*
  Adapter to the ZgeSkelet Library, a wrapper for a skeletal-based
  3D character animation library Cal3D.
  http://home.gna.org/cal3d

  Download Windows DLL and Android shared library from
  http://googledrive.com/host/0BxwfQ8la88ouZElvWnZpLVhSdGs/

  Project home
  http://code.google.com/p/zgeskelet

  Copyright (c) 2014 Radovan Cervenka
*/

// Core models

// Creates a new core model. Returns ID of the created core model
// which is used in other functions to refer to the core model.
int zsk_CreateCoreModel(string name) {}

// Frees the previously created core model from memory.
void zsk_DestroyCoreModel(int coreModel) {}

// Loads skeleton of a core model from file.
// Returns 1 if successful, or 0 if an error happened.
int zsk_LoadSkeleton(int coreModel, string file) {}

// Loads skeleton of a core model from memory buffer.
// Returns 1 if successful, or 0 if an error happened.
int zsk_LoadSkeletonBuffer(int coreModel, xptr buffer) {}

// Loads animation of a core model from file.
// Returns the assigned ID of the loaded animation,
// or -1 if an error happened.
int zsk_LoadAnimation(int coreModel, string file) {}

// Loads animation of a core model from memory buffer.
// Returns the assigned ID of the loaded animation,
// or -1 if an error happened.
int zsk_LoadAnimationBuffer(int coreModel, xptr buffer) {}

// Loads mesh of a core model from file.
// Returns the assigned ID of the loaded mesh,
// or -1 if an error happened.
int zsk_LoadMesh(int coreModel, string file) {}

// Loads mesh of a core model from memory buffer.
// Returns the assigned ID of the loaded mesh,
// or -1 if an error happened.
int zsk_LoadMeshBuffer(int coreModel, xptr buffer) {}

// Loads material of a core model from file. The specified
// material user ID can be used to determine the material assigned
// to the rendered sub-meshes of a model instance, see the
// zsk_GetSubmeshUserMaterialId() function for details.
// Returns the assigned ID of the loaded material,
// or -1 if an error happened.
int zsk_LoadMaterial(int coreModel, int userId, string file) {}

// Loads material of a core model from memory buffer. The specified
// material user ID can be used to determine the material assigned
// to the rendered sub-meshes of a model instance, see the
// zsk_GetSubmeshUserMaterialId() function for details.
// Returns the assigned ID of the loaded material,
// or -1 if an error happened.
int zsk_LoadMaterialBuffer(int coreModel, int userId, xptr buffer) {}

// Creates a new core material thread with the given ID.
// (See the Cal3D User's Guide for details about handling materials.)
void zsk_CreateCoreMaterialThread(int coreModel, int threadId) {}

// Sets a core material ID for a material thread / material set pair.
// (See the Cal3D User's Guide for details about handling materials.)
void zsk_SetCoreMaterialId(int coreModel,
				int threadId, int setId, int materialId) {}

// Model instances

// Creates a new model instance from the specified core model.
// Returns ID of the created model instance which is used in other
// functions to refer to the model instance.
int zsk_CreateModelInstance(int coreModel) {}

// Frees the previously created model instance from memory.
void zsk_DestroyModelInstance(int modelInst) {}

// Attaches a mesh to the model instance.
// Returns 1 if successful, or 0 if an error happened.
int zsk_AttachMesh(int modelInst, int meshId) {}

// Detaches a mesh from the model instance.
// Returns 1 if successful, or 0 if an error happened.
int zsk_DetachMesh(int modelInst, int meshId) {}

// Sets the level of detail (LOD) for all attached meshes.
// The LOD level is in the range [0.0, 1.0].
void zsk_SetLevelOfDetail(int modelInst, float lod) {}

// Interpolates the weight of an animation cycle to a new value
// in a given amount of time. If the specified animation cycle is
// not active yet, it is activated. The delay is specified in seconds.
// The weight is in the range [0.0, 1.0].
void zsk_BlendAnimCycle(int modelInst, int animationId, float weight, float delay) {}

// Fades an animation cycle out in a given amount of time.
// The delay is specified in seconds.
void zsk_ClearAnimCycle(int modelInst, int animationId, float delay) {}

// Executes an animation action. The delayIn parameter is the time
// in seconds until the animation action reaches the full weight from
// the beginning of its execution. The parameter delayOut is the time
// in seconds in which the animation action reaches zero weight at the
// end of its execution.
void zsk_ExecuteAction(int modelInst, int animationId, float delayIn,
							float delayOut) {}

// Executes an animation action. The delayIn parameter is the time
// in seconds until the animation action reaches the full weight from
// the beginning of its execution. The parameter delayOut is the time
// in seconds in which the animation action reaches zero weight at the
// end of its execution. The parameter weightTarget is the weight to
// interpolate the animation action to. If the parameter bAutoLock is
// set to 1, it prevents the action from being reset and removed
// on the last keyframe.
void zsk_ExecuteActionExt(int modelInst, int animationId, float delayIn,
							float delayOut, float weightTarget, int bAutoLock) {}

// Updates the model instance for a given amount of time. To reach real-time
// animation use ZAplication.DeltaTime as value of deltaTime.
void zsk_Update(int modelInst, float deltaTime) {}

// Sets the material set of all attached meshes.
// (See the Cal3D User's Guide for details about handling materials.)
void zsk_SetMaterialSet(int modelInst, int setId) {}

// Sets the material set of the specified mesh instance.
// (See the Cal3D User's Guide for details about handling materials.)
void zsk_SetMeshMaterialSet(int modelInst, int meshId, int setId) {}

// Meshes and textures

// Returns the number of meshes attached to the model instance.
int zsk_GetMeshCount(int modelInst) {}

// Returns the number of sub-meshes in a given mesh.
int zsk_GetSubmeshCount(int modelInst, int meshId) {}

// Returns the (file) name of the first texture attached to
// a material of the specified sub-mesh.
string zsk_GetSubmeshTexture(int modelInst, int meshId, int submeshId) {}

// Returns the user ID of a material attached to the specified sub-mesh.
int zsk_GetSubmeshUserMaterialId(int modelInst, int meshId, int submeshId) {}

// Rendering

// Renders the whole model instance. If bSetColor is set to 1, rendering sets
// the color of sub-meshes as specified in their materials. If bSetColor
// is 0, rendering does not change the sub-mesh colors. If bRenderTexture
// is set to 1, rendering uses the texture of the current material to render
// all meshes of the model instance. If bRenderTexture id set to 0, the model
// is not rendered with textures.
void zsk_RenderModelInstance(int modelInst, int bSetColor, int bRenderTexture) {}

// Renders a single sub-mesh of the model instance. If bSetColor is set to 1,
// rendering sets the color of the sub-mesh as specified in its material.
// If bSetColor is 0, rendering does not change the sub-mesh color.
// If bRenderTexture is set to 1, rendering uses the texture of the current
// material to render the sub-mesh. If bRenderTexture id set to 0, the sub-mesh
// is not rendered with texture.
void zsk_RenderSubmesh(int modelInst, int meshId, int submeshId,
        int bSetColor, int bRenderTexture) {}]]>
      </Source>
    </ZExternalLibrary>
    <ZLibrary Comment="Globals">
      <Source>
<![CDATA[const int FALSE = 0;
const int TRUE = 1;

const int NUMBER_OF_MESHES = 20;
const int NUMBER_OF_ANIMATIONS = 7;
const int ACTION_ANIMATIONS_FROM = 5;
const int NUMBER_OF_MATERIALS = 4;
const string RESDIR = ANDROID ? "/assets/skeleton/" : "skeleton\\";

int SkeletonCoreModel;

byte[] fileBuffer;

// Utils

// load file and store it in a buffer which is then returned
byte[] load(string filename){
  @FileAction(File:
    @File(FileName: RESDIR + filename, Encoding: 1, TargetArray: fileBuffer),
    Action : 0);

  return fileBuffer;
}]]>
      </Source>
    </ZLibrary>
    <ZExpression Comment="Init">
      <Expression>
<![CDATA[// set instruction text
InstructionText.Text = ANDROID ?
  "Tap to activate animations..." :
  "LMB click to activate animations...";

// create core model
SkeletonCoreModel = zsk_CreateCoreModel("skeleton");

// load skeleton
zsk_LoadSkeletonBuffer(SkeletonCoreModel, load("skeleton.csf"));

// load animations
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_idle.caf"));
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_walk.caf"));
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_jog.caf"));
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_hiphop.caf"));
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_strut.caf"));

zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_wave.caf"));
zsk_LoadAnimationBuffer(SkeletonCoreModel, load("skeleton_shoot_arrow.caf"));

// load meshes
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_head.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_calf_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_calf_right.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_chest.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_foot_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_foot_right.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_hand_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_hand_right.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_head.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_hair.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_lowerarm_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_lowerarm_right.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_neck.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_pelvis.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_spine_lower.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_spine_upper.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_thigh_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_thigh_right.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_upperarm_left.cmf"));
zsk_LoadMeshBuffer(SkeletonCoreModel, load("skeleton_upperarm_right.cmf"));

// load materials
zsk_LoadMaterialBuffer(SkeletonCoreModel, 0, load("skeleton_bone.xrf"));
zsk_LoadMaterialBuffer(SkeletonCoreModel, 1, load("skeleton_hair1.xrf"));
zsk_LoadMaterialBuffer(SkeletonCoreModel, 2, load("skeleton_hair2.xrf"));
zsk_LoadMaterialBuffer(SkeletonCoreModel, 3, load("skeleton_hair3.xrf"));

// set materials; all are added to set 0
for(int i = 0; i < NUMBER_OF_MATERIALS; ++i){
  zsk_CreateCoreMaterialThread(SkeletonCoreModel, i);
  zsk_SetCoreMaterialId(SkeletonCoreModel, i, 0, i);
}]]>
      </Expression>
    </ZExpression>
    <SpawnModel Model="SkeletonModel" SpawnStyle="1"/>
  </OnLoaded>
  <OnClose>
    <ZExpression Expression="zsk_DestroyCoreModel(SkeletonCoreModel);"/>
  </OnClose>
  <OnRender>
    <UseMaterial Material="TextMaterial"/>
    <RenderText Name="InstructionText" Text="LMB click to activate animations..." Y="0.92" Scale="0.3"/>
    <RenderText X="-0.8" Y="0.24" Scale="0.5" Align="1">
      <Text>
<![CDATA[idle
walk
jog
hip hop
strut]]>
      </Text>
    </RenderText>
    <RenderText Name="CurrentAnimationPointer" Text="&gt;" X="-0.85" Y="0.24" Scale="0.5" Align="1"/>
    <RenderText Text="wave" X="0.4" Y="0.56" Scale="0.5" Align="1"/>
    <RenderText Text="shoot arrow" X="0.26" Y="-0.62" Scale="0.5" Align="1"/>
  </OnRender>
  <Content>
    <Group Comment="Artwork">
      <Children>
        <Material Name="BoneMaterial" Color="1 1 0.8 1" Shininess="128" DrawBackFace="255"/>
        <Bitmap Name="DroidBitmap" Width="4" Height="4" Filter="2">
          <Producers>
            <BitmapFromFile Comment="Imported from Droid.bmp">
              <BitmapFile>
<![CDATA[78DAED5D3B921CB90EECE3CE21F6087382BDC0FAE3CB1E57AE4C99EBC994B70F31192F03228B2008B27EDD4843D1EAE9AA6291491004F1793C1289442291482412092FFEFB13BF7FFFFEEBAFBFEEFE3A39AC0927DEDEDEF0E1EFBFFFFEF5EB17A640F23FF18210C90FFE7CFFFEFDF4C67C7C7CFCFCF95326E3109F03FCC7949767C91393032F8ECFCFCFD345A84C43D09ED89BFF4FA3FE25562D01270AC31F3F7EA00DDFBE7D1B65636CF2CA53E459B8569E9E347865FCFBEFBF4203D90B9CABC3CB4A74B0FE7F85B56FE1B64E94582EA3329A9E79FDCF3FFF881EC8D550EB84FE9E797F7FE71D6453E96C706BEFC975B975A1BC267ED31295A35A3D5A22901719D51F5A08705804F2C1FCE71270003F354988D82B7B1448CF7B914805441E0A8DFD3D83FBA001CEC554662B1F47838CA66EF1FDA6C46ECD11B4447E333A2ECEF992FC0FF35F7AF8DBFFB190FF542029BD8548B63413C9AFD9CE466A323B7B86C3D7E52D81F905C1AB970C69FFE6F7F5F469911CCB99FCD5D30C4E5E4C28E7FBA2EB16EE1C5F87FF9A930BF90F320C19F1C0934DA5172474F60CC94045C2F352E879E89F5AEF051B3DC281725BBF35155AA726C365887773EE82F1A0550707C9FFE33BD0DE735125766E1E4142B0C2B391C4EC439FC8E7E26ED082F4F7F6F0C91CD42B9ABF1F700734186BA87F178CDF3BB5ACE4FF35F9DFBA845B03A7F110BA4AF15FCFA881F0FA7B30D0392E20A1C86121FFD00644AF9BE8044E1FE7DAC1C64FDA0FB9D5C22C3E92FF7C65BFD5E245F8EF940C98265A6662E1B035314C132D75D12DE822D0890B81DF7A336AC3E4E873A730AA46721B12305DCAB5F2BE54D8C2EBC8A400E7C6475A22ED716E9A92FFB5FC2CF60E5DE281E7F83DB46E3C149F31B33C22511B70FCA27B537A07ECE1B4BC0D49EFC2DA16B3FC2FE13FDE9AB3603F75E8F9F85FCB4F7D676323C94DAE368B156B01E68547146B2BAE5F7473D6E811E1767888CC01C5A9F04098F13E9A67AC3E36EADEAD1E5691007207ACC2F26F8B51CFC7FF96F6DBDD48E2427605577FF4A1EEAEAE5640EED516E051CD4D6FCC47B51174D7A84514FA0FB8173E7D9EE43F4F21A1FF781E275D0D8927BB067D78AA57B4A7E7BFB1D5E586AED59FC59DD1877A223847B638E7ED9E0BD772BE9E2C9C50A3B6FDD684F2AF4427EE7F47B7FC0564044103E95808A2A7E73F8FC90CA9B2B9ACA31F344FA075E389FA92629968ED3EF494B1CF856B716DDC36A093E0E9819DECBDEC9F7215D72CE9A55A506C2EC14FC67FDBEE611C0FE1CE5A6BD267C15A064292B45AC8735EDDFFC6B9B09FE133675B1EF3D7DDF97F91FDEFA417CA0CFF5B3B5FCF46B266B5F605D264AE674A6DA8A9B52FAA13ADB9D9D570A856B51492F4FFB902FFE55AE1C6A63EB637FFF150FB7CB6A50C4042165ACDE67173AD2915FB8B56E36983DD24F04CE393FFD7B47FFA1D6F121744F27F12DAA29EB829FF9F3BFE6557FE43A74DFEDF14AF10FFB82BFF97DF2D71245E21FE7D6FFE27EE8EE7CE7FB26BFC57E2C5F70ED76FE7AEF1BF89442291482412894422914824F640CBEFE50A89945FA1E777B29C1CE911716B7C7C7CE870691D0A148BE34824FFEF0EB8E175F3F62492FF4F89ECBDE47FF23F7B2FF99FFC4F24FF4FEC87EE8B6C66AE2830944E6AB4F78CF63344B1654D9A697CFDDCFA1BFB4596A40E7B7CB9C4D0F3F9F7EFDFF2D99387503F5DFE6500A07C189A149BD73A1B3F3307E51D655875DC229CF146CD2693A3F0F9F9F9F30B3A7F20D35900A39EB14BF84F6760631F3DD3F88BF0BF557CA16B4066E696CDD05767F689D6B507F0DF105943A9335649A185ABEA12FE07F2410D35FE0AFC67E0957CC03C957FF597DDF633F3242FE773BBF637AE9EC5E5BFBFB037FF91EF4EA43D0594AC836CBCFFFCE829F9CF043E434BCFBDF8CF7C17F51D78ADF1FA9496B5C2C0CB0DC5D5C81EA05D948FDF838CA69D793EFE5325184DC77D2FFEDB51B7DD25C0CE74DD95A276667B671D9CFDF8BF8AB177E13F079AAF1F084ABA17FFED042CDD04A41ECB8071B97D46E924E172FEB37C83FFF0F439F88FA164C69E98FBD0BDF86FBF69B7F2C864E1127B7D3960FF5BA88232F434620CE9BDCFC17F6DC099AC01712FFEDFF4F2556CD1B65F6EDB87AA6F3C07FF45D5A7CE192E3E7247FEDBA953C304765EDE5A7D8EE1BF66BE0840697360E8EDE42D77E13F8C1831B3CFB9FC0FF7FC12FDBF357D8CB29E9EA73BEBBECD28AB9CA1CC9A3E23F45AF6A2B5BBE903EC3F335320C07F3D76359F3DFC0FF7BCCD31A7FDC7CE4D1AB6FF38EB7EDA3D602350A6D0DE3F6EF6D5A82BF215EC9F2CE618CB8136C47FF287D99EB5CCB48B594CF63CCDEC86FDDFD0070C070F5E6EC855E3E9743B71F23FB604ACDA3BEB7340610E7B436BD47E9F8A8B9C7F513A05CAC90DF15FFA0D8656EAA2A8E60086D8324AEFDC633DCFD7D427B0A3E7BF82B5E7BFA4935FFF872491977DFF82F48034DE7E775DB296D31C47C0B8D5D0A0D7C5FB88EE12432F9A583E22E9B49F0AA3E9FB5A4F0C4C8100FFB5AC0367EA044DB6079D66FB68CF3FA6FD7F5A4F9FF4FFE1E9B0A70DD23F45377A5E5F385F7B6D056C807AD0913A4F8FA6873CB517E510FF37337A2DF1FF1C9D0201FE435C17BA0ABF917F8D47EB77949F057A9ED716FE9FCE0A74549096FB7F3E7C09E5F46F440C4ACBB97038CBB9168C850BE850FADFBB67905BD8FE4CA6F78248FE27FF93FFC9FFE47FF27F1E500567CE23A8B73BEB9824FF13171974EE64275397ACDAFF7A3069BC4A24FF6F2DFF278D5789442291482412894422914824128944620FB49C06E908F4DCF9F3FF1B4772E669000B399DCF89B7B737A13DA7C6A41D7E928DC9FFC4AEA36F9C1075C33FEFCEFF44F2DFD0701850707CDB327B79626F40BC1B313ECC0495FC4F3C1F98DC5BA6C07B854016386397317A9397E2BF6CB8A49774D412DD87F0A5BD8833F5C14C0496B4A1085FFDF5EBD78F1F3F9C06909900AECDA70B61E41B7FD187B0DB15857CCB04144B83C3F78AD5617C1DFE530AD5C1A74C07D11D77E1C94C042EA3DD635BB0C9005E8EF54CDD9330FF5BEF8E1404E13468FAD586F2E7BF1AFF1975ABAD70F2D999007F3E033F0920C3844AB23A7F4277EC2613F8B39D3A7503D40FAC897BF37F577F5D8E4BF2DFEEFF3A4D0185BF87FFE10CFC7C4ACCCA3799C09FEAC1AA0C5401A681A2A3D5B53C98311FBD1AFF37ADD05C1ABA97CF67E08F2DF49309FC471303EEA7FFCF4FC0D6EBC71233BE0EFF99E424D6099319F83146E1239EC904FE76FECFC3D49862FF12A87F5783CB5F6CFBFC3AFCA7FDA12E93E7E7FF6406FE988C7A4C27F0F7A498DB9BFFDA6C2543C0FF86FB64C6EC19E33FDADC9AB320D81221B3130A0308064217940C8FFB6406FE49D6399FBEC4E724F6229B5B24232BE9DE66CF18FFB1D168A97060D11E1B9C8540F1117905A17D6D0E0D8FFB64067E27EBC209FC4FE77F4B4587F40EAB8561B36758FF0167EA4D1CA6C69585FF642778F4FF6E06FEF0404F26F0B72F1FDA1DC7F8DFCD7D1DEB96B0D933DC0074755DAE0E3D7C71E13FCFFFB0FD871CDBC3FED3D5DFEC32A398BC4ED9751DFE2FF19A1B6D00ECD8851C83227753E1EF91DE8FE90CFCD454634BC064027F3EBD165C3C98D823ED70211E6BCD1996E7589FCC983D672620D8A24D28F8E6FA213CD242549E228791C7D8A39C6B4F95B5E7BFD88F747B6F32813F9F2EAF89CB117E826B6319C803B2BA387C0F57BF9D347BCEF01FEF42631A04C8CC1EE460391F4B416F575E98F7FFF1AC9EAD473B07B1557D40EE606B654BF6CE7C3AD29E6BE3839047BE199A059366CF49050C3E27BA257789DF1415451A5C38407AA499967B6BFD3FE5B33469C6FFD33F88A840AA3D603DAC839578D37B70C87654D44D0848805566CF49FE438E0997D0925B08FF495C39DDE291879857E88779B3E764D781F6DFBF7023E19FFC7F8E7E98377BCE771D163269C989C21F2EFDC73420F9AFB93769759934624CBEEC92F87736E32CE14FC3DD31870EC9FF621B2B1B075DC971D20EE3C7BCD97355FE8713853F83B90E3B7448FE53F5DDDC08EFE1D89CB085C09127CEC97F3D050A1B1A4C5849CB4422914824128944229148241289C4C5F1F1F1715F37FE4462063CDACBB38CC44EB86CEE7D921FF93073A412AFC37F9D1C32C728B137FF2F758C3E199A9A481CC6FF55D307FBDC6219F2A83D7603E019D5728A7B7F7FFFFCFCAC63DFFCD9EF9774850EA182075D20FE14AFD0CAA86034B8DE5B7593D376C3F379873D7238ACADDA763AFF5B69F09D9ABFD100EE205A6910ECAE93F11DDA7704BAC27E77FF7D988DD9EFFECD78ED7ACAE8C48C36BD5B2F4B51E64CAEF2B2FCD704106923E388FCF33A3639D6008EAF218240335902F05C66BFD74FF7A7C7097405F3E420F32A9E4EF2F8A7800E2477DACA74F593629A7331323A9F791E8C99E5EF8AA1DFF36575D580162ECE7F8E752DB518CFE249035237C023828C3F3198C5EF463BDA15C60BEA21F63FBA9B75AD2630A85EB499DFDBB7C2E4AD1B6FE4B55ED57593C9EB2EC27F72AC9B46CF20EA660348AD19C58C559277EA0A3BC9BF5F98F36587B210403ED42982994CA6CEAAD452BAB4986563868A478F761D635EE69DFC4FE47F374D197BD8D80F6E36C0DEF68E366FA7AEB053E87B52C0E95FE23EFEF465CC0F5914DAC31DA886D92A449DA8301604176011B93119EE7A22FFA9A2046C1446033CD57FFC8BEC7EF27F328173B1158588D06B81E7E948BFA3FB8AAFECC9A451AC38ECF9D19CA23339CC270B352EE1BFAEA3EA7F7708405B587535BDA201140B932E1354BDF6D3FF2753E817DB5876BBA719BABE24A60C7EAFF3C9A301DDD7D1243CBE145DB7CCCD31FCDF34DF7517268F89B8BB46B41A105B168545A860E8B43E9DCE7FC8103DD921CF6DC589261ACA708C8296F9688067FAA30D619D938D89D118CF0D8BBB9DF8EF31E0EFCAFF512D5406BDC86639DAA5C7F37F3355325520A3E769FCD1047EFC5974DB9F435B9F3E0C6D7B0B23704C6AB1130287863BE9FFD275D41F0C81B090FFBA013A07B247A4A0E4AE4EA7CC8CC417E77F6B8FD0ADAE850BD9F3ACA1A07B0CFCF7C8735DF074B4DFA83EA14931930595C00346CD7F395BD5BAF94EFC2F8492FD6AFAE468B2FCDFF1FC6F2DFD50810CE50DBDCA4763C9801CA614E5DED6692808ACB98F3F3307E2734C8C775FF914FB8FBDC35DB8FFDD6C40F7FE541596B8581FCC7F4EF05AE5E81AE15B542F44E8D0063C907F0FC28732DF3853F6DBEB0E30BDFA2FB7A5F74EF64FFFFDD163AB52C61DCC7FFB78CE3E1EAAEDC39B5DE13123EB07D9558D5A5A939E2F338964E94B3374F989FCEF9E7FB18B46CFBF8674A72555688FE7BFCD70C31782BDDAB5546352185BDA5AEB683945384D97934B40E0F47957FEDB36B1FDFC1FF4587437E077E47F77A08DE351FEC949D1560B37A5D3A65384D1FEFA67938E0D5C16F7703D1DBA5C1778EA6E6F97FBBF512F352EEF9EF00E9D631EC97F8F91BFB53B2E8C9FDD4D654B3EB4B6579E3329C34D227C88ECDF332EE7BF3EFF15E8B232F64CD4FECFDA0778D4FF5937C0EFC04C6105FB1BBDA0A5192C09D4DACDD5AEB69B5D6188C130FFB95DB557AED6EAE9AF548536D82CAD5FB01B1DD065B8BD04747D9E9D927321FF5B9017E96A62460C88270265F2E92C38385A876E3E0423CC7FA7B9BBE53D686B351EFE77DD2FA9C6D70CE7EC30C8697B70ED11FF128E7F6F116F3488AF887FF45F3EFF7419913AFA52682FABBF2EA9701DFEFBCD569B2A8ADFCCDEAA6CE231B6D78E197AF675F5734341BA14FF138944229148241289442291482412894422914824128944229148241289C47DB1E930F9FDFBF7D1009CB017D3AA0204DA679B55000CFFB7C78A0076FBADED9782CF9E4E1E829EF767BDF3C46E77A387667CFFF85FB864EB96782EDF7C531DCBDCED81B0D7A5A713A4EBFC09A8CFE57F91F9676F074EE2E7178AA7C37FB59B8CC268B0337391D17E4F0EC985FCAF43D7C3FCD7093D8C779FAC3A51B444077D14D54C9C59E0EAB0116716F779FEB3B50CC011881CE8E6005F92C02DFC22225EA4D3A49DECA5CFCF4F5D5020FCC46EFD97F9812B7AA68E758AF15F0B7FE3F2F9AA13DD3E94BBF111F66C3AB7008111A4D925F0B9FC6FC15F3BC02E9D10AE3CE27F597CD6E9B38A2CA6A3FC67F0AF7DF97CD4ADA7133C15584EE7BFD1C29BF2FFE14E42BEF9449DCFE718FEE3891044DC36C6F8CF2619972FC9BAE0EC04DE2A1C06BB2B6D38D69BBBF5FBF2DF5908C6289D30A33E8DF21FD164A025239A03FC675CBFCEEE6B8CCB4CD509672770AE1991DA27F2DFAEC0725FFE3B1F5D3F91818DF3A2CFCFFF5F5FC0D4E3BC0BF01F33173BB8BDB3AEF93BA12B4F4EE4BF9D28E3D5F83F5AB76E15FFC9343033C67FBC32E691CDFF255937FD9D104E601B36408DDA8E8AB929A20F1776B588E7E03FEBA77888B19CFFE02A6E8266A331A3FCA7F0EFF27F49D6E5E5FC8F11D863851EE53FC9E33462B75A3E548DF144FEB3134653882FE13F9A8A5186E20D0E0FF19FF9AB8B85EC46FC0FA7B0389DFFF32938CEE5BFCC531A0C8752412EE13F761CDA7A8F360CF1BF4867FD82FC9F1985D18CD94FC67FF9B1918D736FFE73F3CBEF311C7EFEA3F1FAB4E252FCEF6A95A7EF7FC3F9CF9F69FF3B9A367615FF0B330BB7C07EFE8360BA19D7D9FF7A92DD9DC8FFA1938EA7B7FF8C16559FE7BFDEFC023805D3E529EDCB6BE1DFE5FF91F6CFEE59C3B9FCE7BABF47E9B4DBF19F593DE7DDE7FCD76E968F6FE55DACF9BF99CB74F2FCCB5375C2D309F432B2158C73FD1FD0C258C185E73BFFF29C572EE4BFDEFCEA06746B7FDB7E0E36FF8FF17F90A7D017D18E053897FF7481D85CF7ED1E783EFEEB35716FFF1F9139C5E6977F727ADEB66ACDD8FC7FECE0FFA66DE07207FA151CE6FF1CBE5CCF77E94FBA13D3FF79D7F8970BF25FEF85F773DC257B5B09A2FD36C37A80BAFC9FAF3AE1B1017AD2EF3F16C5BF4C5A2075D0843F08EBDCF897FDF8FF7054C659A2FF6C5E4EE5C7C3FF4D29DDE5FF63BAEA84413F440EFAC7EE0AFC7FFCBF66377536E99CEE5B9C1BFFB82BFFB933DAC9706DD48BA706E2E1FFE6EAECE13FB5DFC9F8C74422914824128944229148241289442291482412896BA208204A245E0A38730F07C22412B706531E855D6E5E167077ACD350FB138027AE003A2F655738A15DDCE13C03CCFB2FDD0E6F6F6FA242683F46E987A154C6FA42B9552C20116ACC5012038203371403FE4CEADF50BF71C5947EAB7B4CA686DC6D7331F547591ABF349C06477DD8E0F7A8A92B9F871C38B5C3DE4217E880F4184DB95073C01FF8F07C6B9FBFDF18291950171970648B3846696D92B9EBF1EBF46136FCDEFD6EC39C354C9E8FF81167FE73BCAC162C14C5A3927C86FF14682FA8028D06816E46DDFAE78E6770298E36A7492BE8490691B157DDD721CDE497D8B090BAF084F7BC0E1ED7FAF1503CF5E6C41CD24666F49F3D8000ED9D6EBEA97884F7B0FE701B48663DE2A49C7C80286342B64DD1E7A92F60A78DB535042E310613182221723BA66C7B5A0242C6A2CBB129D88F3F07303FBC18F97B7EE12C7002CC21B518294656738220C2D750985B33AE6B8E73665D3676195CF266C8FF581D03BBD94BFE60B48BD803B99D970FFB19540F7BD0A6F4C6A483A425C9C97C8C1A9399D893B7C67CCE64FB0EA4D6BC85AA1583AFD5989D12ACDD9DF94BD2272E99051053CEA5169253D34C3F5467FD85AABFA9FDDA1BCF6EFAA949FE4FE63DDB94F0B594F667D2B0275760FB7022F3610718DAADCF072F4FCE82227FB2A7D9FA739DC04AFF605309A186636026679A9DE47032EF656B3BA34D559C171E73A2CC1D1D7B4E0AE1CEFE8C7CE732FF7855DCD8740CCD024F9A4A27FF8BD873630AB75474D6A0092B06DD126693798F0D6B154EAF86F269B78E0FBE7F61D72DE412B3E11598DF9A057ECB0347A1BBDAAEE27F4B09F1CCC496FD531731EF96DC5A6B5AE181057BDE43097D7CC0DF4B87C8D4FEFD852BF3FF3A92DF580586D632E6AB346C0EB5FEAFD77D2E25DD322E9B275CCE4CECF6C917E685C774B690FCBAA0B0A71BF562B7394C7A420D2D4361FB7FE0F2E7D07F347BE909D0BA1C8FC0C86E6E9C3581EDE1ABB574FB38C9C37FB95B7704D7F29FA7E1BA703CCDC2F6161B17B61A1C2B21145E2FC297DF7DFFDBEAF6CDE90C29C1476004B52ACE6BB1161834E326B1287BED24F066D5750FF19C05BE87BAAB9EB3B669D4B391D145FDAECCFFBBDB3F872C6F30DDF04FC2732EF7C22BAA014CCE6F1080CA1254202A3F5DB3A427739DF15C6E57971C2DD51240B37766238FD5D06FFF3C5EFF398C90073FC83EB8C48893A530DF91F9F0FF97BF62F8EC8669274FFC7EBEEA4AF7F88CD6D725BE8EADC6780E7FF1FA2D86879D0C2FB509DDE911BB6E3AECB1C35F6DB984ED5B57C7D0EEA0ABAAAE7B7A9EA263BEF75A8E3A6886ADBD18C7671E3BF02D66C14E379F67BEB1FA778B64417019F2133FF093994E7493A5E7B91BB58947C363CB50E93F1A2687E5156889E5EB74BD17E88924BFA4172BA77086D1ED04EEAD44DFA3EB6FE1B86E743E2D7EF534A462E6D42E74B588A1D24BB5FD5F37BE4B3C7DF0C42A00B8894773DBB418D4675843B6D302198DBB1F74A0E226BAA25B24A43E682B821FFDAAB5E6E12AD39973D99509DEE25EE0F4444FE4D1F20D325B6979463CC2BDDC3EEF08E961E9766DB409C49F22E444EFC4BBC74F2D1D2060E8AE8DFF81D07B5401601B3097E5CB79EFB8442291482412894422914824128944229148241277070E41F2D036F19A98CC769248DC1ACEE0CD44E2293194462391783E9C98B101E90B04431B90AE1FBB07F0F7A62337FCC003F719CA7737193E89241B85F39BE8AE43A9EF6B38335EA26044F17484AE0F755D1D7A36942D706D22AC87F2AA3D7E17AC5D10033ADBBCD6572010477924FF97E4CF0FF33F9CF9D0D3F3C8C17B8AC6AE63610EE6FF68CE8462CD8A65192DCAA04C06EF0CF19F31171F1F1FEF6D18CF82B42CF2E7F3B6B1DCC87EFE0B438A96EBAEEB460193BA7209E37790366A286CB01B2C1FE3C3F156A098FC7F8C6799A81F5A475BC416D6D17CBFE0AA5FDC151A48771003ACF0EB3F5D62DB2A44ABB404D34639BBB1CEC1725FEB5340FFD7DBF6D10BC9935ACCF24F434B4020DFF5CC143060075F1BCB8DCE1D642F405DB5DC88E1C21C6935CF9F47428FFEEB54EB6BB1683456DD4EF062A7F65AC5FF87CAE6B4700AD862FCBF11ECB189B013E38C569D70269DDB0F01F575790302099140BCD6ACB1FFBA90FF0F956D6FD514E0B2724DFE43ED5C557585A37F56B285B5BD1743C0106A6739084895998578E114A00ADD5ABC90286C53C198A9F853BF8BDD51AD9E0F54DD3AB7D2C415F81F30842EAFFD34A9887669D35D7CA513A8C0DB2B179E554F9079FE73200C59447A6C4EF600999D55599F1BA386D0ABF1FFE1C85BD5153E38BFEB9A0298B5A6D051FD6F5D9B6D75F67E4FDA4C94D8932792B47213661189E5A0B84EF1D0E3114BB77B29FE9396FE71ACC9EF640E64664154E75B1B59778A44E2469BA5A9ADC45381E3577BCBF30A1835845E90FF7A291FDD08C8EF99187928759BD69486CE7F7F7DA1285DE1D9846A03A90C16653EEE10DB0185CDE0CF842143E8F2DA97C714E574AADF4E1A144AA393FF3315E4F7B358064C764F862143E875EC9FF353AF96AECE4D44D163C7F07FA7435B7F01822786DF106ADBD93CBB69A4D02CAA9FCCF37FD208337A39FA01D3ADA87F67F33FEC75B3593B6C09B074BEF22ED86F08F5F83FD8EB487174BB56FE87F9CF5DC0A8D0C0DED9732D1E31A369ACAD6154CCFD57DE053F460CA193FE6F427B6E0039EFFCFC87EB63ABFD5D03784BCAB52AF3DA0B193BCDC3FFA18AF3B6DEB5BC3C74EE82FD86D025FECF452AF251C7459DBB5E1745B29F4EE50D2697D1CB5BEB262F77F6F08CDF0BD729B94F719AD09D3B06AE5F757D6F0C99C29698A049E621F94F0204B2F7CB406BDBE37CF0CEE3CF4A164E2573F2DC5FF79BFFF2FD3C979E064386505DEF261CFFC85A0C43FA3F02098BD209FEA7A36A830E9D08076F6A85B04B1E6A2FF3DC6328A53E3E4BFE27128944229148241289442291482412894422914824E681144CFEB36FA6F1392BF14222B190FC20F3D0F1B1FC7868CA24AE8C973D371F8D1AD3A00F614E81E4FF1D311F8DC298E517AF9C42B7D8C302D06AC662398E356088FF70D9AA392374A2379D7C3022684472B2EE00BCF5F4DD3C897496A015043104F4C68B17CF0AF8004F02DDAE39866F9C8208195F0B077E67090988CD22D48881243FBF60A4746BF95D23033013A1ECEDC74E0FE4C9BC73A3799B9F121465CBE33A5B80A4D56C07AF9C0D30BC673DF210CFD2235E7C0376D5915C94ED603B0237A4CD854BFF01717CCE5833FF58BC72EC2132801D593E0C04D30CACBFB1F9AFEB385082394519026DF488834E94A59B6BC443858CD552974131CB93A21B5BD72506CCB5771BB241BDECBE038254873B61149CDA6CB14DA0FEEFCF4002BA72CAD73B88CD3D85516447EB457B6FA32603ED5BEBE9C1F5135F39DA05425BB3BDFE26D093432944F48EDB29FF5BEB0B0D296BCBFAD8BBA78509A34EC9407529FE1FB603DA23837D8CFF5AC9870EDCD5FF37F3DC52014344FC01C3BABCD61B0D5FAFC9FF19D97B29FE8FE661C6EFE5F569B7B1ED3F9C5F3434D170C4871E70A8B4DC62B3A47C40F23FB0E6EA1DD09009B4EE4946A3FBF77110D77871A7FD9F4F01C3EBFA17788B5D6B3A9CCE7FF9BDD6F110CE3FBAEB7971FE6313A7B98A3DE9900D1659086652707309F05FA2D33ED4332E5006E55EFA0F7A4CBF203BC49802DDD413279E449FC2FFDAE0895DA43F078ECE7B835D67C0F082770F146FD5D5CF0F1EAF73F7BF85E390B63F77FB39F95F3C542FA3FE6650EBD66A8FE7A19B4A0E467F68E12846F3605FE240A650CF82E2973CDACE1C9E8CD7D17F62DB9F3A99A433BDE4FC16984543C03A67E35B4E0E8125807B5E5DFA27B0E78D25E4BCC2F9176B41866BD627FFC3FC2F8A0D391B6F383914F64F677771CFABCB4F1FC0FFC722E737ADFC8C6A80741C0A4FC3BBF3BF4EA63D9A5E1B92538B0EA709A850389D8D370EB96A8F882EF78AED672C7D6B3821F92AD765A7F6CE771470BD2B20DD821F38D782BBF39FCE30C637A32650F0A12B4F0A063A1F6A3B3940867B74E04DC2ACEAC35133D412FF67E7B4D5CC47CE525C5BCC881791FFF3FCC773B5C1D3E905C706EBD20F2276E0C8D7923F5D2707670CC2A69343AC8EE10CFFE75D97479DA87F7C41C60B5D848D039E8ECE97BFFA57C0EBF8BFD12432D49E79FED706CFDA28642BF34349C8BB4E0EF8A6FB743E9A0FA23632EAF933C3FFC75CFCE3CCB5BABB9EA06811476188FFB4405260D6DF8CDA5D21D386F29FEB9AB6227C64385A4FF73839146B44D7FA5A584147CD20A33DB68AC6F3E47FACA826736BFED76716A3A7189BBBCE80163169FFAF9724CF98CA44D309FC633E9F4BCE7D58C2E0E0FC2759B7F422C8BA09278ACD172F5A974824128963F03FC441213C]]>
              </BitmapFile>
            </BitmapFromFile>
          </Producers>
        </Bitmap>
        <Font Name="DroidFont" Bitmap="DroidBitmap" FirstChar="32" CharPixelWidth="21" CharPixelHeight="32"/>
        <Material Name="TextMaterial" Shading="1" Color="1 1 0.502 1" Light="0" Blend="2" ZBuffer="0" Font="DroidFont"/>
      </Children>
    </Group>
    <Model Name="SkeletonModel">
      <Definitions>
        <Variable Name="SkeletonInstance" Type="1"/>
        <Variable Name="SkeletonCurrentAnimation" Type="1"/>
      </Definitions>
      <OnRender>
        <UseMaterial Material="BoneMaterial"/>
        <ZExpression Expression="zsk_RenderModelInstance(SkeletonInstance, TRUE, FALSE);"/>
      </OnRender>
      <OnUpdate>
        <ZExpression Comment="Update animation" Expression="zsk_Update(SkeletonInstance, App.DeltaTime);"/>
        <KeyPress Name="NumberKeys" Keys="{" RepeatDelay="0.5">
          <OnPressed>
            <ZExpression Comment="Change animation">
              <Expression>
<![CDATA[int i;

if(App.MousePosition.X < 0){
  i = SkeletonCurrentAnimation + 1;
  if(i == ACTION_ANIMATIONS_FROM) i = 0;
} else {
  if(App.MousePosition.Y < 0)
    i = 6;
  else
    i = 5;
}

if(SkeletonCurrentAnimation != i){
  if(i < ACTION_ANIMATIONS_FROM){
    // change cycle animation
    zsk_ClearAnimCycle(SkeletonInstance, SkeletonCurrentAnimation, 2);
    zsk_BlendAnimCycle(SkeletonInstance, i, 0.5, 2);
    SkeletonCurrentAnimation = i;

    CurrentAnimationPointer.Y = 0.24 - i*0.09;

  } else {
    // trigger action animation
    zsk_ExecuteAction(SkeletonInstance, i, 0, 0);
  }
}]]>
              </Expression>
            </ZExpression>
          </OnPressed>
        </KeyPress>
      </OnUpdate>
      <OnSpawn>
        <ZExpression Comment="Init model instance">
          <Expression>
<![CDATA[// create instance
SkeletonInstance = zsk_CreateModelInstance(SkeletonCoreModel);

// attach meshes
for(int i = 0; i < NUMBER_OF_MESHES; ++i)
  zsk_AttachMesh(SkeletonInstance, i);

// set material set; ther is only set 0
zsk_SetMaterialSet(SkeletonInstance, 0);

// start animtion
SkeletonCurrentAnimation = 0;
CurrentAnimationPointer.Y = 0.24;

zsk_BlendAnimCycle(SkeletonInstance, 0, 0.5, 0);]]>
          </Expression>
        </ZExpression>
      </OnSpawn>
      <OnRemove>
        <ZExpression Comment="Destroy model instance" Expression="zsk_DestroyModelInstance(SkeletonInstance);"/>
      </OnRemove>
    </Model>
  </Content>
</ZApplication>
